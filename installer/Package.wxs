<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
    <Package Name="DS Claude Client"
             Manufacturer="DS"
             Version="1.0.0.0"
             UpgradeCode="A1B2C3D4-E5F6-7890-ABCD-EF1234567890"
             Compressed="yes">

        <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
        <MediaTemplate EmbedCab="yes" />

        <StandardDirectory Id="ProgramFiles64Folder">
            <Directory Id="INSTALLFOLDER" Name="DS Claude Client">
                <Directory Id="RuntimesFolder" Name="runtimes">
                    <Directory Id="WinX64Folder" Name="win-x64">
                        <Directory Id="NativeFolder" Name="native" />
                    </Directory>
                </Directory>
            </Directory>
        </StandardDirectory>

        <StandardDirectory Id="ProgramMenuFolder">
            <Directory Id="ApplicationProgramsFolder" Name="DS Claude Client" />
        </StandardDirectory>

        <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
            <Component Id="MainExecutable" Guid="B1B2C3D4-E5F6-7890-ABCD-EF1234567891">
                <File Id="DS_ClaudeClientExe" Source="..\publish\DS_ClaudeClient.exe" KeyPath="yes" />
            </Component>
            <Component Id="D3DCompiler" Guid="B1B2C3D4-E5F6-7890-ABCD-EF1234567892">
                <File Id="D3DCompilerDll" Source="..\publish\D3DCompiler_47_cor3.dll" />
            </Component>
            <Component Id="PenImc" Guid="B1B2C3D4-E5F6-7890-ABCD-EF1234567893">
                <File Id="PenImcDll" Source="..\publish\PenImc_cor3.dll" />
            </Component>
            <Component Id="PresentationNative" Guid="B1B2C3D4-E5F6-7890-ABCD-EF1234567894">
                <File Id="PresentationNativeDll" Source="..\publish\PresentationNative_cor3.dll" />
            </Component>
            <Component Id="VCRuntime" Guid="B1B2C3D4-E5F6-7890-ABCD-EF1234567895">
                <File Id="VCRuntimeDll" Source="..\publish\vcruntime140_cor3.dll" />
            </Component>
            <Component Id="WebView2Loader" Guid="B1B2C3D4-E5F6-7890-ABCD-EF1234567896">
                <File Id="WebView2LoaderDll" Source="..\publish\WebView2Loader.dll" />
            </Component>
            <Component Id="WpfGfx" Guid="B1B2C3D4-E5F6-7890-ABCD-EF1234567897">
                <File Id="WpfGfxDll" Source="..\publish\wpfgfx_cor3.dll" />
            </Component>
        </ComponentGroup>

        <ComponentGroup Id="RuntimeComponents" Directory="NativeFolder">
            <Component Id="WebView2Runtime" Guid="B1B2C3D4-E5F6-7890-ABCD-EF1234567898">
                <File Id="WebView2CoreDll" Source="..\publish\runtimes\win-x64\native\WebView2Loader.dll" />
            </Component>
        </ComponentGroup>

        <ComponentGroup Id="ShortcutComponents" Directory="ApplicationProgramsFolder">
            <Component Id="ApplicationShortcut" Guid="B1B2C3D4-E5F6-7890-ABCD-EF1234567899">
                <Shortcut Id="ApplicationStartMenuShortcut"
                          Name="DS Claude Client"
                          Description="Claude AI Desktop Client"
                          Target="[INSTALLFOLDER]DS_ClaudeClient.exe"
                          WorkingDirectory="INSTALLFOLDER" />
                <RemoveFolder Id="CleanUpShortCut" On="uninstall" />
                <RegistryValue Root="HKCU" Key="Software\DS\DS Claude Client" Name="installed" Type="integer" Value="1" KeyPath="yes" />
            </Component>
        </ComponentGroup>

        <ComponentGroup Id="DesktopShortcutComponents" Directory="DesktopFolder">
            <Component Id="DesktopShortcut" Guid="B1B2C3D4-E5F6-7890-ABCD-EF123456789A">
                <Shortcut Id="DesktopShortcut"
                          Name="DS Claude Client"
                          Description="Claude AI Desktop Client"
                          Target="[INSTALLFOLDER]DS_ClaudeClient.exe"
                          WorkingDirectory="INSTALLFOLDER" />
                <RegistryValue Root="HKCU" Key="Software\DS\DS Claude Client" Name="desktopShortcut" Type="integer" Value="1" KeyPath="yes" />
            </Component>
        </ComponentGroup>

        <StandardDirectory Id="DesktopFolder" />

        <Feature Id="ProductFeature" Title="DS Claude Client" Level="1">
            <ComponentGroupRef Id="ProductComponents" />
            <ComponentGroupRef Id="RuntimeComponents" />
            <ComponentGroupRef Id="ShortcutComponents" />
            <ComponentGroupRef Id="DesktopShortcutComponents" />
        </Feature>
    </Package>
</Wix>
